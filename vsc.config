tower {
  accessToken = 'c6f9fe249f9a24a49cf3d19f7bedcb1983786788'
  enabled = true
}

singularity {
	container = 'docker://laurenshannes/revivid'

     runOptions = "-B $launchDir -B  /vsc-hard-mounts/leuven-archive/arc_00086"
  autoMounts = true

  enabled = true	


}



profiles {
	docker {
    enabled = true
    runOptions = '-u \$(id -u):\$(id -g)'
  }

    cluster {
        process.executor = 'PBS'
		executor.submitRateLimit = '10 sec'
        process.memory = '4 GB'
		process.cpus = 18
		process.clusterOptions = '-A lp_revivid'
		process.cache = 'lenient'


    }
	    slurm {

    process {
      executor = 'slurm'
      submitRateLimit = '25/1min'
      memory = '4 GB'
      cpus = 4
      clusterOptions = '--cluster=wice -A lp_revivid'
      queueSize = 200
      exitReadTimeout = '60000 sec'
      pollInterval = '1 min'
      queueStatInterval = '5 min'

  
  withName: '.*:alignment' {
    cpus = 30
    memory = 56.GB
    
  }
  withName: '.*:createfamilyvcfs:combineGVCFs' {
    cpus = 8
    memory = 40.GB
  }
  withName: '.*:createfamilyvcfs:genotypeGVCFs' {
    cpus = 2
    memory = 16.GB
  }
  withName: '.*:createfamilyvcfs:normalizeindelsgatk' {
    cpus = 1
    memory = 1.GB
  }
  withName: '.*:createfamilyvcfs:variantrecalibration' {
    cpus = 3
    memory = 16.GB
  }
  withName: '.*:createfamilyvcfs:vcftoolshardfilter' {
    cpus = 1
    memory = 1.GB
  }
  withName: '.*:createindividualbams:splitbamindividuals' {
    cpus = 2
    memory = 1.GB
  }
  withName: '.*:createindividualvcfs:applyBQSR' {
    cpus = 2
    memory = 8.GB
  }
  withName: '.*:createindividualvcfs:baserecalibrator' {
    cpus = 2
    memory = 8.GB
  }
  withName: '.*:createindividualvcfs:combineindividualGVCFs' {
    cpus = 8
    memory = 64.GB
  }
  withName: '.*:createindividualvcfs:genotype' {
    cpus = 2
    memory = 16.GB
  }
  withName: '.*:fastQC' {
    cpus = 1
    memory = 1.GB
  }
  withName: '.*:generateCRAM' {
    cpus = 4
    memory = 1.GB
  }
  withName: '.*:mergebams' {
    cpus = 2
    memory = 1.GB
  }
}


    }

	
    test {

    withName: 'alignment|mergebams|deeptrio|parliament2' {
        cpus = 1
        memory = 8.GB
		time = 30.minute
		executor = 'PBS'
		clusterOptions = '-A lp_revivid'
		cache = 'lenient'
    }
					process {
		    withName: '!alignment|!mergebams|!deeptrio|!parliament2|!check.*|!splitbamindividuals' {
        cpus = 1
        memory = 4.GB
		time = 30.minute
		executor = 'PBS'
		clusterOptions = '-A lp_revivid'
		cache = 'lenient'
		
    }
    withName: 'check.*|splitbamindividuals' {
        cpus = 1
        memory = 8.GB
		time = 30.minute
		executor = 'local'
		cache = 'lenient'
    }	

}
    }
}


cleanup = true